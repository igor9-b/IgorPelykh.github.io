!function(e){"use strict";e.config(["$stateProvider","$urlRouterProvider","$locationProvider",function(e,t,n){var o=1;t.otherwise("/"),n.hashPrefix("!"),e.state("index",{url:"/",redirectTo:"SelectLanguage"}),e.state("SelectLanguage",{url:"/step/"+o+++"/",templateUrl:"application/steps/select_language/view.ng.html",data:{nextStep:"Agreement"}}),e.state("Agreement",{url:"/step/"+o+++"/",templateUrl:"application/steps/agreement/view.ng.html",data:{nextStep:"ServerTest.testing"}}),e.state("ServerTest",{abstract:!0,url:"/step/"+o+++"/",template:"<ui-view/>"}),e.state("ServerTest.testing",{url:"testing/",templateUrl:"application/steps/server_test/view.ng.html",data:{nextStep:"RetrieveProductInfo"}}),e.state("ServerTest.error",{url:"error/",templateUrl:"application/steps/server_test/error.ng.html",data:{nextStep:"ServerTest"}}),e.state("RetrieveProductInfo",{url:"/step/"+o+++"/",templateUrl:"application/steps/retrieve_product_info/view.ng.html",data:{nextStep:"FilesDownloading"}}),e.state("FilesDownloading",{url:"/step/"+o+++"/",templateUrl:"application/steps/files_downloading/view.ng.html",data:{nextStep:"FilesDownloading"}})}]),e.run(["$rootScope","$state","$transitions",function(t,n,e){t.$state=n,t.lockRedirects=!1,t.goToNextStep=function(){n.current.data&&n.current.data.nextStep&&(t.lockRedirects=!1,n.go(n.current.data.nextStep))},t.goToStep=function(e){angular.isString(e)&&(t.lockRedirects=!1,n.go(e))},e.onStart({},function(){if(t.lockRedirects)return!1;t.lockRedirects=!0}),t.goToStep("index")}])}(angular.module("application.routing",["ui.router"])),function(e){"use strict";e.service("apiRequest",["$http","$q",function(o,r){var i="./api.php";this.getAction=function(e){var t=r.defer();return e?o.get(i,{params:{action:e}}).then(function(e){e&&e.data&&e.data.status&&e.data.result?t.resolve(e.data.result):t.reject(e)}).catch(function(e){e&&e.data?t.reject(e.data):t.reject(e)}):t.reject(null),t.promise},this.postAction=function(e,t){var n=r.defer();return e?(t=t||{},t=angular.extend({},t,{action:e}),o.post(i,t).then(function(e){e&&e.data&&e.data.status&&e.data.result?n.resolve(e.data.result):n.reject(e)}).catch(function(e){e&&e.data?n.reject(e.data):n.reject(e)})):n.reject(null),n.promise}}]),e.service("errorModal",["$rootScope",function(n){n.error={visible:!1},this.open=function(e,t){n.error={visible:!0,message:e,retryFn:function(){this.close(),t&&t()||angular.noop}.bind(this),isRetriable:!!t}},this.close=function(){n.error={visible:!1}}}])}(angular.module("application.services",[])),function(e){"use strict";angular.module("application.filters",[]).filter("resourceName",function(){return function(e){return e.split("@").pop().split("_").map(function(e){return e.charAt(0).toUpperCase()+e.slice(1)}).join(" ")}})}(),function(e){"use strict";e.controller("application.steps.controller.Agreement",["$scope",function(e){e.agreement=!1}]),e.controller("application.steps.controller.FilesDownloading",["$scope","$rootScope","$window","$filter","apiRequest","errorModal","ApplicationConfig",function(o,e,t,n,r,i,a){var s="error",c="success",u={engine:"APPLICATION.RESOURCE_TYPES.ENGINE",theme:"APPLICATION.RESOURCE_TYPES.THEME",plugin:"APPLICATION.RESOURCE_TYPES.PLUGIN"},l=-1;function p(n){r.postAction("download-required-resource",{resource:n}).then(function(e){return e.resource.downloaded?(t=n,void r.postAction("extract-installation-file",{resource:t}).then(function(){t.status=c,o.processResourcesQueue()},function(){t.status=s,o.processResourcesQueue()})):p(n);var t},function(){n.status=s,o.processResourcesQueue()})}function f(){r.postAction("clear-temp-files").then(function(){o.filesPreparationStatus="success",t.location.href="../"+a.get("product.controlPanelPath")},function(){o.filesPreparationStatus="error",i.open(null,f)})}function d(){r.postAction("copy-installation-files").then(f,function(){o.filesPreparationStatus="error",i.open(null,d)})}function g(){o.filesPreparationStatus="active",r.postAction("check-installation-files").then(d,function(){o.filesPreparationStatus="error",i.open(null,g)})}o.filesPreparationStatus="",o.processResource=function(e){e.status="active",p(e)},o.resources=e.productResources.map(function(e){return{info:(t=e,{label:u[t.type],translationParams:{item:n("resourceName")(t.uid)}}),type:e.type,uid:e.uid,status:""};var t}),o.processResourcesQueue=function(){var e;if(l++,!(e=o.resources[l]))return o.resources.every(function(e){return e.status===c})?void g():void 0;o.processResource(e)},o.processResourcesQueue()}]),e.controller("application.steps.controller.RetrieveProductInfo",["$scope","$rootScope","ApplicationConfig","apiRequest","errorModal","$translate","$sce",function(n,o,e,r,i,t,a){function s(){return o.$body.hasClass("dark-ui")?"dark":"light"}function c(e){var t;return"https://accounts.motocms.com"===e.origin&&(t=e.data,angular.isString(t)&&(t=angular.fromJson(t)),"accounts"===t.module&&(!!angular.isObject(t.body)&&(!(!t.action||"startDownloadFiles"!==t.action)&&void r.postAction("prepare-to-install",t.body).then(function(e){o.productResources=e.resources,n.goToNextStep()},function(){i.open()}))))}var u,l;n.$frame=null,n.frameLoaded=!1,n.onLoadFrame=function(e){n.$apply(function(){n.frameLoaded=!0,n.$frame=e})},n.accountsUrl=a.trustAsResourceUrl((u=e.get("externalModules.licenseCenter"),l=u.url,l+="?app_id="+u.appId,l+="&app_version=2",l+="&language_locale="+t.use(),l+="&ui_theme="+s(),l+="&environment="+encodeURIComponent(btoa(angular.toJson(u.environment))))),window.addEventListener("message",c,!1),n.$on("$destroy",function(){window.removeEventListener("message",c,!1)}),n.$on("uiThemeChanged",function(){if(!n.$frame)return!1;n.$frame[0].contentWindow.postMessage(angular.toJson({action:"setUiTheme",value:s(),module:"Moto3Installer",requestId:Date.now(),responseId:1,version:1}),e.get("externalModules.licenseCenter.url"))})}]),e.controller("application.steps.controller.SelectLanguage",["$scope","$translate",function(e,t){e.language="en_US",e.setLanguage=function(){t.use(e.language),window.localStorage.setItem("installation_selected_locale",e.language)}}]),e.controller("application.steps.controller.ServerTest",["$scope","$rootScope","$q","apiRequest","errorModal","ApplicationConfig",function(t,n,o,r,i,a){var s={php_version:"APPLICATION.ERROR_MESSAGE.PHP_VERSION",php_extensions:"APPLICATION.ERROR_MESSAGE.PHP_EXTENSIONS",php_classes:"APPLICATION.ERROR_MESSAGE.PHP_CLASSES",php_functions:"APPLICATION.ERROR_MESSAGE.PHP_FUNCTIONS",php_settings:"APPLICATION.ERROR_MESSAGE.PHP_SETTINGS",disk_resources:"APPLICATION.ERROR_MESSAGE.DISK_RESOURCES"};function c(e){return e.filter(function(e){return!1===e.status}).map(function(e){return{label:(t=e.checker,s[t]||"APPLICATION.ERROR_MESSAGE.BROKEN_RESPONSE"),params:function(e){if("php_version"!==e.checker)return{items:"disk_resources"===e.checker?e.requirements.map(function(e){return e.path}).join(", "):e.requirements.join(", ")}}(e)};var t})}function u(){var e;e=a.get("checking").filter(function(e){return"check-network-connection"===e.action})[0].resources.map(function(e){return r.postAction("check-network-connection",{resource:e})}),o.all(e).then(function(e){e.some(function(e){return!1===e.status})?i.open("APPLICATION.ERROR_MESSAGE.NETWORK_RESOURCES",u):t.goToNextStep()}).catch(function(){i.open()})}r.getAction("check-server-requirements").then(function(e){e.status?u():(n.errors=c(e.report),t.goToStep("ServerTest.error"))},function(){i.open()})}])}(angular.module("application.steps",["application.services","application.filters"])),function(e){"use strict";angular.module("application.core.util",["ng"]).provider("CoreUtil",[function(){var e=this;this.getValue=function(e,t,n){var o,r,i,a;if(angular.isNumber(t)){if(isNaN(t))return n;t+=""}if(!angular.isString(t)||t.length<1)return n;if(angular.isDefined(e[t]))return e[t];a=t.split(".");try{for(r=e,o=0,i=a.length;o<i;o++)angular.isDefined(r)&&(r=r[a[o]]);if(angular.isDefined(r))return r}catch(e){}return n},this.$get=function(){return e}}])}(),function(e){"use strict";angular.module("application.core.config",["application.core.util","application.config.value"]).provider("ApplicationConfig",["CoreUtilProvider","application.config.value",function(o,r){var e,t,n,i,a=this,s="production";if(!angular.isObject(r))throw console.error('[ ApplicationConfig ] : "application.config.value" is not object'),new Error('[ ApplicationConfig ] : "application.config.value" is not object');angular.isDefined(r.env)&&-1!==["development","testing"].indexOf(r.env)&&(s=r.env),e="development"===s,n="testing"===s,i="production"===s,(t=!0===r.debug)&&(console.log("[ ApplicationConfig ] : start"),console.log("[ ApplicationConfig ] : config",r)),this.isDebug=function(){return t},this.isDevelopment=function(){return e},this.isTesting=function(){return n},this.isProduction=function(){return i},this.getStage=function(){return s},this.get=function(e,t){var n=o.getValue(r,e,t);return n&&(n=angular.copy(n)),n},this.$get=function(){return a}}])}(),function(e){"use strict";angular.module("application.core",["ng","ui.router","pascalprecht.translate","application.core.util","application.core.config"]).config(["ApplicationConfigProvider",function(e){e.isDebug()&&(console.log("[ application.core:config ] : start"),console.log("[ application.core:config ] : end"))}])}(),function(e){"use strict";e.directive("motoOnLoad",function(){return{restrict:"A",link:function(e,t,n){t.on("load",function(){if(n.motoOnLoad)try{e.$eval(n.motoOnLoad,{$element:t})}catch(e){console.warn("motoOnLoad : Error on eval"),console.error(e)}})}}}),e.directive("motoWelcome",function(){return{restrict:"A",templateUrl:"application/directives/views/welcome.ng.html"}})}(angular.module("application.directives",["ng","application.templates","application.translations"])),function(e){"use strict";e.config(["$translateProvider","ApplicationConfigProvider",function(e,t){t.isDebug()&&console.log("[ application:config ] : start"),e.preferredLanguage("en_US"),e.fallbackLanguage("en_US"),e.useSanitizeValueStrategy(null),t.isDebug()&&(console.log("[ application:config ] : ENV",t.get("env")),console.log("[ application:config ] : end"))}]),e.run(["$rootScope","ApplicationConfig","$localStorage",function(e,t,n){e.$body=angular.element(window.document.body),n.moto_ui_preferred_theme=n.moto_ui_preferred_theme||"dark",e.updateUiThemeClasses=function(){"dark"===n.moto_ui_preferred_theme?e.$body.removeClass("light-ui").addClass("dark-ui"):e.$body.removeClass("dark-ui").addClass("light-ui")},e.switchUiTheme=function(){n.moto_ui_preferred_theme="dark"===n.moto_ui_preferred_theme?"light":"dark",e.updateUiThemeClasses(),e.$broadcast("uiThemeChanged")},e.initUiThemeClasses=function(){e.$body.addClass("moto-ui-disable-transitions"),e.updateUiThemeClasses(),setTimeout(function(){e.$body.removeClass("moto-ui-disable-transitions")})},e.initUiThemeClasses(),t.isDebug()&&(console.log("application:run"),console.log("$rootScope",e))}])}(angular.module("application",["ng","application.routing","application.steps","pascalprecht.translate","application.core","application.directives","ngStorage","application.templates","application.translations"]));